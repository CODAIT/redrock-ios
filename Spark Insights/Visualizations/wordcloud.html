<html>
  <head>
    <title>Topic Clouds</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <script src="http://d3js.org/d3.v2.min.js?2.10.0"></script>
    <script type="text/javascript" src="d3.layout.cloud.js"></script>
</head>

<body>
  <p id="test"></p>

<script>


wordScale=d3.scale.linear().domain([1,100,1000,10000]).range([10,20,40,80]).clamp(true);
wordColor=d3.scale.linear().domain([10,20,40,80]).range(["#5596E6","#8CD211","#FF5003","#E71D32"]);

//(["#c2e4f8","#86c3ea","#69a4d8","#5e93cd","#4278bc", "#325c80", "#264a60", "#1c3648", "#142834", "#010205"]);

function makeCanvases(number){


//d3.selectAll(("#svg" + topic[0].topic + " > *").remove();
d3.selectAll("svg").remove();

  for (x = 0; x < number; x++) {
  	viz = d3.select("body").append("svg")
      .attr("width", 465)
      .attr("height", 400)
      .attr("id", "svg" + x);
  }
}
//for (x = 0; x < 3; x++) {

//x=0;

//d3.json("topic.json", function(topic) {
//d3.csv("topic_words"+x+".csv",

function renderSingle(topic) {


  d3.layout.cloud().size([465, 400])
//      .words([{"text":"test","size":wordScale(.01)},{"text":"bad","size":wordScale(1)}])
      .words(topic)
      .rotate(function() { return ~~(Math.random() * 2) * 5; })
      .fontSize(function(d) { return wordScale(d.size); })
      .on("end", draw)
      .start();

  function draw(words) {

	viz = d3.select("#svg" + topic[0].topic);


      viz.append("g")
        .attr("transform", "translate(265,220)")
      .selectAll("text")
        .data(words)
      .enter().append("text")
        .style("font-size", function(d) { return d.size + "px"; })
        .style("fill", function(d) { return wordColor(d.size); })
        .style("opacity", .75)
        .attr("text-anchor", "middle")
        .attr("transform", function(d) {
          return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
        })
        .text(function(d) { return d.text; });

        /*
		viz
        .append("text")
        .data([topic[0]])
        .style("font", "20px sans-serif")
        .style("font-weight", 900)
        .attr("fill", "grey")
        .attr("x", 190)
        .attr("y", 20)
        .text(function(d) { return "TOPIC " + (d.topic); })*/

//  d3.select("#svg"+x).append("svg:text").text("Topic " + x);
//    viz.enter().append("svg:text").text("Topic " + x);

  }

}

function renderChart(data) {    
    makeCanvases(data.length);

    for (i = 0; i < data.length; i++) {
        renderSingle(data[i]);
    }
}


/*
data2 = [[
  {"text": "access", "size": "1238", "topic": "0"},
  {"text": "streets", "size": "1020", "topic": "0"},
  {"text": "transportation", "size": "982", "topic": "0"},
  {"text": "system", "size": "824", "topic": "0"},
  {"text": "pedestrian", "size": "767", "topic": "0"},
  {"text": "provide", "size": "763", "topic": "0"},
  {"text": "bicycle", "size": "719", "topic": "0"},
  {"text": "major", "size": "696", "topic": "0"},
  {"text": "coordinate", "size": "72", "topic": "0"},
  {"text": "separated", "size": "68", "topic": "0"}

],
         [
  {"text": "buildings", "size": "460", "topic": "1"},
  {"text": "plan", "size": "451", "topic": "1"},
  {"text": "policy", "size": "442", "topic": "1"},
  {"text": "neighborhoods", "size": "327", "topic": "1"},
  {"text": "civic", "size": "301", "topic": "1"},
  {"text": "community", "size": "249", "topic": "1"},
  {"text": "strategies", "size": "235", "topic": "1"},
  {"text": "existing", "size": "222", "topic": "1"},
  {"text": "lots", "size": "221", "topic": "1"},
  {"text": "walkable", "size": "217", "topic": "1"},
  {"text": "upper", "size": "46", "topic": "1"},
  {"text": "added", "size": "46", "topic": "1"},
  {"text": "long", "size": "43", "topic": "1"}

],
 [
  {"text": "development", "size": "818", "topic": "2"},
  {"text": "transit", "size": "746", "topic": "2"},
  {"text": "centers", "size": "647", "topic": "2"},
  {"text": "mixed", "size": "640", "topic": "2"},
  {"text": "urban", "size": "443", "topic": "2"}
  ],
 [
  {"text": "graboid", "size": "3333", "topic": "3"},
  {"text": "kazoo", "size": "222", "topic": "3"}
  ]];
 

renderChart(data2);
*/
 
/*
text,size,topic
access,1238,0
streets,1020,0
transportation,982,0
system,824,0
pedestrian,767,0
provide,763,0
bicycle,719,0
major,696,0
arterial,596,0
local,452,0
centers,415,0
service,388,0
connections,373,0
adjacent,337,0
arterials,335,0
facilities,317,0
modes,312,0
design,310,0
high,305,0
travel,284,0
areas,282,0
regional,275,0
serve,269,0
circulation,257,0
safe,241,0
vehicle,233,0
demand,228,0
roadway,223,0
improvements,218,0
corridors,211,0
capacity,208,0
activity,208,0
roadways,207,0
collector,202,0
modal,198,0
automobile,185,0
oriented,183,0
function,182,0
locations,182,0
light,174,0
convenient,172,0
trails,169,0
employment,156,0
classification,151,0
paths,151,0
designed,148,0
accommodate,136,0
primary,135,0
direct,135,0
type,131,0
wide,130,0
bicyclists,129,0
map,129,0
destinations,129,0
intersections,129,0
users,128,0
bikeways,126,0
complete,126,0
trail,120,0
bus,117,0
long,114,0
effective,113,0
providing,111,0
volumes,111,0
includes,110,0
standards,99,0
points,99,0
ride,99,0
truck,97,0
developments,97,0
emergency,94,0
bicycling,92,0
collectors,90,0
develop,86,0
motor,85,0
hours,80,0
additional,80,0
boulevard,79,0
balance,78,0
ridership,74,0
address,74,0
coordinate,72,0
serving,72,0
significant,72,0
stops,71,0
citywide,70,0
recreational,70,0
multiple,70,0
freeway,68,0
separated,68,0
minor,68,0
principal,68,0
highways,68,0
connect,66,0
amenities,66,0
landscaping,65,0
low,65,0
crossings,64,0
stop,64,0
sidewalks,63,0
*/




</script>
